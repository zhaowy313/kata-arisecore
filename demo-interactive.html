<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WGo.js Interactive Go Board</title>
    <script type="text/javascript" src="../wgo/wgo.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px;
      }

      .container {
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        padding: 40px;
        max-width: 700px;
        width: 100%;
      }

      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 10px;
        font-size: 2.5em;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .subtitle {
        text-align: center;
        color: #666;
        margin-bottom: 30px;
        font-size: 1.1em;
      }

      #board {
        width: 100%;
        margin: 0 auto 30px;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        justify-content: center;
        margin-bottom: 20px;
      }

      button {
        padding: 12px 24px;
        font-size: 16px;
        font-weight: 600;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }

      button:active {
        transform: translateY(0);
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-secondary {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        color: white;
      }

      .btn-success {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        color: white;
      }

      #status {
        text-align: center;
        font-size: 20px;
        font-weight: bold;
        color: #333;
        margin: 20px 0;
        padding: 15px;
        background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        border-radius: 10px;
      }

      .info {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
      }

      .info h3 {
        color: #667eea;
        margin-bottom: 10px;
      }

      .info p {
        color: #666;
        line-height: 1.6;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üéÆ WGo.js Interactive Board</h1>
      <p class="subtitle">Click on the board to play! Black plays first.</p>

      <div id="board"></div>

      <div id="status">Turn: Black ‚óè</div>

      <div class="controls">
        <button class="btn-secondary" onclick="resetBoard()">
          ‚ôªÔ∏è New Game
        </button>
        <button class="btn-success" onclick="passMove()">‚è≠Ô∏è Pass</button>
        <button
          class="btn-primary"
          onclick="window.location.href='../playable.html'"
        >
          ‚öôÔ∏è Advanced Features
        </button>
      </div>

      <div class="info">
        <h3>üìñ How to Play</h3>
        <p>
          <strong>Goal:</strong> Capture territory by surrounding empty spaces
          with your stones.<br />
          <strong>Capture:</strong> Surround opponent's stones to remove
          them.<br />
          <strong>Ko Rule:</strong> Can't immediately recapture - prevents
          infinite loops.<br />
          <strong>Pass:</strong> Click "Pass" when you don't want to play. Game
          ends when both pass.
        </p>
      </div>
    </div>

    <script>
      var game;
      var board;
      var currentPlayer;
      var passCount = 0;

      function init() {
        var element = document.getElementById("board");

        // Initialize board with modern theme
        board = new WGo.Board(element, {
          width: 600,
          background: WGo.DIR + "wood1.jpg",
          section: {
            top: -0.5,
            left: -0.5,
            right: -0.5,
            bottom: -0.5,
          },
        });

        // Add click listener
        board.addEventListener("click", function (x, y) {
          playMove(x, y);
        });

        resetBoard();
      }

      function resetBoard() {
        // Initialize Game with KO rule (standard Japanese rules)
        game = new WGo.Game(19, "KO", false, false);
        currentPlayer = WGo.B;
        passCount = 0;
        updateBoard();
        updateStatus();
      }

      function playMove(x, y) {
        var result = game.play(x, y, currentPlayer);

        if (typeof result === "object") {
          passCount = 0; // Reset pass count on successful move
          updateBoard();
          currentPlayer = currentPlayer === WGo.B ? WGo.W : WGo.B;
          updateStatus();
        } else {
          // Error codes: 1 (occupied), 2 (suicide), 3 (ko)
          var errorMsg = "Invalid move!";
          if (result === 1) errorMsg = "‚ùå Position occupied";
          if (result === 2) errorMsg = "‚ùå Suicide not allowed";
          if (result === 3) errorMsg = "‚ùå Ko rule violation";

          // Flash error in status
          var originalHTML = document.getElementById("status").innerHTML;
          document.getElementById("status").innerHTML = errorMsg;
          document.getElementById("status").style.background =
            "linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%)";
          document.getElementById("status").style.color = "white";

          setTimeout(function () {
            document.getElementById("status").innerHTML = originalHTML;
            document.getElementById("status").style.background =
              "linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)";
            document.getElementById("status").style.color = "#333";
          }, 1500);
        }
      }

      function passMove() {
        passCount++;
        currentPlayer = currentPlayer === WGo.B ? WGo.W : WGo.B;

        if (passCount >= 2) {
          document.getElementById("status").innerHTML =
            "üèÅ Game Over! Both players passed.";
          document.getElementById("status").style.background =
            "linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)";
        } else {
          updateStatus();
          document.getElementById("status").innerHTML += " (Pass used)";
        }
      }

      function updateBoard() {
        var state = game.getPosition();
        board.removeAllObjects();

        for (var i = 0; i < state.size; i++) {
          for (var j = 0; j < state.size; j++) {
            var color = state.get(i, j);
            if (color === WGo.B) board.addObject({ x: i, y: j, c: WGo.B });
            else if (color === WGo.W) board.addObject({ x: i, y: j, c: WGo.W });
          }
        }
      }

      function updateStatus() {
        var symbol = currentPlayer === WGo.B ? "‚óè" : "‚óã";
        var text = currentPlayer === WGo.B ? "Black" : "White";
        document.getElementById("status").innerHTML =
          "Turn: " + text + " " + symbol;
      }

      window.onload = init;
    </script>
  </body>
</html>
